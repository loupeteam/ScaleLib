<!-- 
*
* File: ScaleLib.html
* Copyright (c) 2023 Loupe
* https://loupe.team
* 
* This file is part of ScaleLib, licensed under the MIT License.
*
-->
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<style>
*{margin:0;padding:0;}
body {
	font:13.34px helvetica,arial,freesans,clean,sans-serif;
	color:black;
	line-height:1.4em;
	background-color: #F8F8F8;
	padding: 0.7em;
}
p {
	margin:1em 0;
	line-height:1.5em;
}
table {
	font-size:inherit;
	font:100%;
	margin:1em;
}
table th{border-bottom:1px solid #bbb;padding:.2em 1em;}
table td{border-bottom:1px solid #ddd;padding:.2em 1em;}
input[type=text],input[type=password],input[type=image],textarea{font:99% helvetica,arial,freesans,sans-serif;}
select,option{padding:0 .25em;}
optgroup{margin-top:.5em;}
pre,code{font:12px Monaco,"Courier New","DejaVu Sans Mono","Bitstream Vera Sans Mono",monospace;}
pre {
	margin:1em 0;
	font-size:12px;
	background-color:#eee;
	border:1px solid #ddd;
	padding:5px;
	line-height:1.5em;
	color:#444;
	overflow:auto;
	-webkit-box-shadow:rgba(0,0,0,0.07) 0 1px 2px inset;
	-webkit-border-radius:3px;
	-moz-border-radius:3px;border-radius:3px;
}
pre code {
	padding:0;
	font-size:12px;
	background-color:#eee;
	border:none;
}
code {
	font-size:12px;
	background-color:#f8f8ff;
	color:#444;
	padding:0 .2em;
	border:1px solid #dedede;
}
img{border:0;max-width:100%;}
abbr{border-bottom:none;}
a{color:#4183c4;text-decoration:none;}
a:hover{text-decoration:underline;}
a code,a:link code,a:visited code{color:#4183c4;}

h1,h2,h3,h4,h5,h6{border:0;}

h1{font-size:200%;margin-top:1em;margin-bottom:1em}

h2{font-size:170%;padding-bottom:.5em;border-bottom:1px solid #d0d0d0;margin-top:1em;}

h3{margin-top:1em;}

hr{border:1px solid #ddd;}
ul{margin:1em 0 1em 2em;}
ol{margin:1em 0 1em 2em;}
ul li,ol li{margin-top:.5em;margin-bottom:.5em;}
ul ul,ul ol,ol ol,ol ul{margin-top:0;margin-bottom:0;}

blockquote{margin:1em 0;border-left:5px solid #ddd;padding-left:.6em;color:#555;}

dt{font-weight:bold;margin-left:1em;}
dd{margin-left:2em;margin-bottom:1em;}
@media screen and (min-width: 768px) {
    body {
        width: 748px;
        margin:10px auto;
    }
}
</style>
<title>ScaleLib.html</title>
</head>
<body>
<p><img src="http://automationresourcesgroup.com/images/arglogo254x54.png" alt="Automation Resources Group" /></p>

<h1>ScaleLib Library</h1>

<p>The ScaleLib library provides a generic linear scaling object and Fahrenheit to Celsius conversion functions.</p>

<h1>Usage</h1>

<h2>ScaleFnCyclic()</h2>

<p>The <strong>ScaleFnCyclic()</strong> function performs a generic linear scaling.</p>

<h3>Initialization</h3>

<p>A variable of type <strong>Scale_typ</strong> must be created to use the linear scaling. The scaling parameters are entered as a point pair, typically in the INIT routine of your program.</p>

<pre><code>Scale.IN.CFG.Point[0].Input:=   0;
Scale.IN.CFG.Point[0].Output:=  0;

Scale.IN.CFG.Point[1].Input:=   100;
Scale.IN.CFG.Point[1].Output:=  32767;
</code></pre>

<p>These scaling parameters could be used to scale from percent to an analog output, for example. If the <strong>Input</strong> values of the two points are identical, then the <strong>Error</strong> status output will be set, and the <strong>OutputValue</strong> will be set to 0.</p>

<h3>Cyclic Operation</h3>

<p>The <strong>ScaleFnCyclic()</strong> function should be called any time you wish to scale a value. It is possible to call this function on the same Scale variable multiple times per scan.</p>

<pre><code>Scale.IN.InputValue:=   50;

ScaleFnCyclic( Scale );
</code></pre>

<p>After this function call, <strong>Scale.OUT.OutputValue</strong> will contain 16383.5, the scaled value as defined by the scaling points above. Note that the input and output values are REALs, so some data conversion may be necessary on either side of the scaling.</p>

<h2>F_to_C() and C_to_F()</h2>

<p>The <strong>F_to_C()</strong> and <strong>C_to_F()</strong> functions convert temperatures from Fahrenheit to Celsius and from Celsius to Fahrenheit, respectively. The functions take the temperature to be converted as a REAL input, and output the converted temperature as a REAL.</p>

<pre><code>Temp_C:=    F_to_C( Temp_F );
Temp_F:=    C_to_F( Temp_C );
</code></pre>

<h1>Reference</h1>

<h2>Scale Data Structure</h2>

<p>The main data structure of the ScaleLib library is the Scale structure (Scale_typ datatype). It is divided into inputs (Scale.IN), and outputs (Scale.OUT).</p>

<h3>Inputs</h3>

<p>The Scale inputs contain the input value and configuration settings.</p>

<ul>
<li><strong>InputValue</strong> &ndash; Input value to be scaled.</li>
<li><strong>CFG.Point[0..1]</strong> &ndash; Point pair which defines the scaling. Points must have different <strong>Input</strong> values.</li>
</ul>


<h3>Outputs</h3>

<p>The Scale outputs contain the scaled output value and status information.</p>

<ul>
<li><strong>OutputValue</strong> &ndash; Scaled output value.</li>
<li><strong>STAT.Error</strong> &ndash; Set if an invalid point pair is specified (Point[0].Input = Point[1].Input). Cleared automatically if a valid point pair is specified.</li>
</ul>

</body>
</html>